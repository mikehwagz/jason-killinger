{% from 'img.macro.njk' import img %}

<div class="px" data-component="related">
  <h2 class="font-nm text-28 m:text-40 l:text-50 leading-115 pb-10 border-b-2 border-black mb-40">
    {{ p.related.title }}
  </h2>
  <div class="grid grid-template">
    <div class="col-span-12 m:col-span-6 l:col-span-5 pt-0 m:pt-25">
      {% for post in p.related.posts %}
        <a
          class="{% classList
            'flex m:block justify-between items-center font-nm text-28 m:text-40 l:text-50 leading-132 mb-15 m:mb-25 l:mb-40 js-links',
            'text-muted-light' if loop.index > 1
          %}"
          href="/post/{{ post.slug }}/"
        >
          <div class="w-9/12 m:w-auto m:inline">
            {{ post.title }}
          </div>
          <div class="{% classList
            'text-black w-20 m:w-30 h-20 m:h-30 m:inline-block ml-0 m:ml-15 js-arrows',
            'opacity-0' if loop.index > 1
          %}">
            {% include 'arrowCursorIcon.njk' %}
          </div>
        </a>
      {% endfor %}
    </div>
    <div class="hidden m:block relative overflow-hidden col-span-6 l:col-span-7">
      {% set firstPost = p.related.posts[0] %}
      {% set firstMedia = firstPost.media if firstPost.type == 'media' else firstPost.thumbnail %}
      {% if media.type == 'image' %}
        <div style="padding-top: {{ 1 / firstMedia.image.asset.metadata.dimensions.aspectRatio * 100 }}%"></div>
      {% endif %}
      {% for post in p.related.posts %}
        {% set media = post.media if post.type == 'media' else post.thumbnail %}
        {% if media.type == 'image' %}
          <a
            class="{% classList
              'block absolute inset-0 js-thumbs',
              'opacity-0 pointer-events-none' if loop.index > 1
            %}"
            href="/post/{{ post.slug }}/"
          >
            {{ img(
              asset = media.image.asset,
              alt = media.image.alt,
              cx = 'relative w-full h-full'
            ) }}
          </a>
        {% endif %}
      {% endfor %}
    </div>
  </div>
</div>
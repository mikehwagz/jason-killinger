<div class="pb-80 m:pb-115 l:pb-150">
  <div class="relative h-screen overflow-hidden" data-component="lazy">
    <img
      class="absolute inset-0 w-full h-full object-cover scale-105 blur-lg"
      src="{{ p.heroImageDesktop.asset.metadata.lqip }}"
      alt=""
    >
    <img
      class="absolute inset-0 w-full h-full object-cover opacity-0 transition ease-out-cubic duration-500 js-img"
      data-src="{{ p.heroImageDesktop.asset.url }}"
      alt="{{ p.heroImageDesktop.alt }}"
    >
  </div>
  <div class="m:grid grid-template pt-40 s:pt-60 m:pt-80 l:pt-100 pb-80 m:pb-115 l:pb-150 px">
    <h1 class="col-start-3 col-span-7 font-nm text-30 xs:text-36 s:text-45 m:text-55 l:text-65 leading-115 mb-20 m:mb-30 l:mb-40">
      {{ p.title }}
    </h1>
    <div class="col-start-4 col-span-6 px-30 m:px-0 mb-40 m:mb-0">
      {{ p.introText | blocksToHtml('editorialText') | safe }}
    </div>
    <dl class="col-start-11 col-span-2 m:pt-18 text-16 m:text-18 l:text-20 leading-115 tracking-[0.01em] px-30 m:px-0">
      {% if p.client %}
        <dt class="text-gray-dark mb-6">Client</dt>
        <dd class="mb-20 m:mb-25 l:mb-30">{{ p.client }}</dd>
      {% endif %}
      
      {% if p.collaborators %}
        <dt class="text-gray-dark mb-6">Collaborators</dt>
        <dd class="mb-20 m:mb-25 l:mb-30">{{ p.collaborators }}</dd>
      {% endif %}
      
      {% if p.location %}
        <dt class="text-gray-dark mb-6">Location</dt>
        <dd class="mb-20 m:mb-25 l:mb-30">{{ p.location }}</dd>
      {% endif %}
      
      {% if p.disciplines | length %}
        <dt class="text-gray-dark mb-6">Disciplines</dt>
        <dd class="mb-20 m:mb-25 l:mb-30">
          <ul class="space-y-6">
            {% for d in p.disciplines %}
              <li>{{ d.title }}</li>
            {% endfor %}
          </ul>
        </dd>
      {% endif %}
      {% if p.year %}
        <dt class="text-gray-dark mb-6">Year</dt>
        <dd>{{ p.year }}</dd>
      {% endif %}
    </dl>
  </div>
  {% for module in p.modules %}
    {% set type = module._type %}
    {% set moduleTemplate %}
      {% include type + '.njk' ignore missing %}
    {% endset %}
    {% if moduleTemplate | trim | length %}
      {{ moduleTemplate | safe }}
    {% else %}
      <p class="text-40 my-100 text text-muted-light">{{ type }}<p>
    {% endif %}
  {% endfor %}
  {% if p.related.posts | length %}
    <div class="px" data-component="related">
      <h2 class="font-nm text-28 m:text-40 l:text-50 leading-115 pb-10 border-b-2 border-black mb-40">
        {{ p.related.title }}
      </h2>
      <div class="grid grid-template">
        <div class="col-span-12 m:col-span-6 l:col-span-5 pt-0 m:pt-25">
          {% for post in p.related.posts %}
            <a
              class="{% classList
                'flex m:block justify-between items-center font-nm text-28 m:text-40 l:text-50 leading-132 mb-15 m:mb-25 l:mb-40 js-links',
                'text-muted-light' if loop.index > 1
              %}"
              href="/post/{{ post.slug }}/"
            >
              <div class="w-9/12 m:w-auto m:inline">
                {{ post.title }}
              </div>
              <div class="{% classList
                'text-black w-20 m:w-30 h-20 m:h-30 m:inline-block ml-0 m:ml-15 js-arrows',
                'opacity-0' if loop.index > 1
              %}">
                {% include 'arrowCursorIcon.njk' %}
              </div>
            </a>
          {% endfor %}
        </div>
        <div class="hidden m:block relative overflow-hidden col-span-6 l:col-span-7">
          {% set firstPost = p.related.posts[0] %}
          {% set firstMedia = firstPost.media if firstPost.type == 'media' else firstPost.thumbnail %}
          {% if media.type == 'image' %}
            <div style="padding-top: {{ 1 / firstMedia.image.asset.metadata.dimensions.aspectRatio * 100 }}%"></div>
          {% endif %}
          {% for post in p.related.posts %}
            {% set media = post.media if post.type == 'media' else post.thumbnail %}
            {% if media.type == 'image' %}
              {% set image = media.image %}
              <a
                class="{% classList
                  'block absolute inset-0 js-thumbs',
                  'opacity-0 pointer-events-none' if loop.index > 1
                %}"
                data-component="lazy"
                href="/post/{{ post.slug }}/"
              >
                <img
                  class="absolute inset-0 w-full h-full object-cover scale-105 blur-md js-lqip"
                  src="{{ image.asset.metadata.lqip }}"
                  alt="{{ image.alt }}"
                ></img>
                <img
                  class="absolute inset-0 w-full h-full object-cover opacity-0 transition ease-out-cubic duration-500 js-img"
                  data-src="{{ image.asset.url }}"
                  alt="{{ image.alt }}"
                ></img>
              </a>
            {% endif %}
          {% endfor %}
        </div>
      </div>
    </div>
  {% endif %}
</div>